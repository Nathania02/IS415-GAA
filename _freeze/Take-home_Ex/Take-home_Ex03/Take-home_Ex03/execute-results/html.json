{
  "hash": "e6720d21f6922067d49064049f3b6bb7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Ex 3\"\nauthor: \"Nathania Yeo\"\ndate: \"October 27, 2024\"\ndate-modified: \"last-modified\"\nexecute:\n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n# 1.0 Overview\n\nIn this exercise, my focus would be on 1st order Spatial Point Analysis, particularly finding out the density and distribution trends of eldercare facilities.\n\n# 2.0 R packages\n\nI will load the following R packages for the following purposes:\n\n1.  [**sf**](https://r-spatial.github.io/sf/): to import, manage and process vector-based geospatial data in R.\n\n2.  [**spatstat**](https://spatstat.org/): to perform 1st- and 2nd-order spatial point patterns analysis and derive kernel density estimation (KDE) layer.\n\n3.  [**raster**](https://cran.r-project.org/web/packages/raster/): used to convert image output generate by spatstat into raster format.\n\n4.  [**maptools**](https://cran.r-project.org/web/packages/maptools/index.html): use it to convert *Spatial* objects into *ppp* format of **spatstat**.\n\n5.  [**tmap**](https://cran.r-project.org/web/packages/tmap/index.html) which provides functions for plotting cartographic quality static point patterns maps or interactive maps by using [leaflet](https://leafletjs.com/) API.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, spatstat, raster, maptools, tmap)\n```\n:::\n\n\n# 3.0 Data Preparation\n\nThe data that I will be using includes:\n\n1.  URA 2014 Master Plan Planning Subzone boundary data. This data is in shapefile format which is downloaded from Data.gov.sg\n\n2.  Eldercare Services. This data provides both the location and information of eldercare services in Singapore. It was downloaded from Data.gov.sg and is in geojson format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare <- st_read(\"data/EldercareServices.geojson\") %>% st_transform(crs = 3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `EldercareServices' from data source \n  `C:\\Nathania02\\IS415-GAA\\Take-home_Ex\\Take-home_Ex03\\data\\EldercareServices.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 133 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.7119 ymin: 1.271472 xmax: 103.9561 ymax: 1.439561\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nmpsz_sf <- st_read(dsn=\"data\",layer=\"MP14_SUBZONE_WEB_PL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\Nathania02\\IS415-GAA\\Take-home_Ex\\Take-home_Ex03\\data' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n```\n\n\n:::\n\n```{.r .cell-code}\nsg_sf <- st_read(dsn = \"data\", layer=\"CostalOutline\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `CostalOutline' from data source \n  `C:\\Nathania02\\IS415-GAA\\Take-home_Ex\\Take-home_Ex03\\data' \n  using driver `ESRI Shapefile'\nSimple feature collection with 60 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 2663.926 ymin: 16357.98 xmax: 56047.79 ymax: 50244.03\nProjected CRS: SVY21\n```\n\n\n:::\n:::\n\n\nSince mpsz_sf does not have the proper crs information, the code chunk below updates the crs information.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf <- st_transform(mpsz_sf, crs=3414)\nsg_sf <- st_transform(sg_sf, crs=3414)\n```\n:::\n\n\n# 4.0 Mapping the datasets\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(sg_sf) + tm_polygons() + tm_shape(mpsz_sf) + tm_polygons() + tm_shape(eldercare) + tm_dots()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n# 5.0 Geospatial Data Wrangling\n\n## 5.1 Convert sf data frames to sp Spatial classes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- as_Spatial(mpsz_sf)\nec <- as_Spatial(eldercare)\nsg <- as_Spatial(sg_sf)\n\nmpsz\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatialPolygonsDataFrame \nfeatures    : 323 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 15\nnames       : OBJECTID, SUBZONE_NO, SUBZONE_N, SUBZONE_C, CA_IND, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C,          INC_CRC, FMEL_UPD_D,     X_ADDR,     Y_ADDR,    SHAPE_Leng,    SHAPE_Area \nmin values  :        1,          1, ADMIRALTY,    AMSZ01,      N, ANG MO KIO,         AM, CENTRAL REGION,       CR, 00F5E30B5C9B7AD8,      16409,  5092.8949,  19579.069, 871.554887798, 39437.9352703 \nmax values  :      323,         17,    YUNNAN,    YSSZ09,      Y,     YISHUN,         YS,    WEST REGION,       WR, FFCCF172717C2EAF,      16409, 50424.7923, 49552.7904, 68083.9364708,  69748298.792 \n```\n\n\n:::\n\n```{.r .cell-code}\nec\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatialPointsDataFrame \nfeatures    : 133 \nextent      : 14481.92, 41665.14, 28218.43, 46804.9  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 2\nnames       :   Name,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Description \nmin values  :  kml_1, <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSBLOCKHOUSENUMBER</th> <td></td> </tr><tr bgcolor=\"\"> <th>ADDRESSBUILDINGNAME</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSPOSTALCODE</th> <td>050005</td> </tr><tr bgcolor=\"\"> <th>ADDRESSSTREETNAME</th> <td>5 Banda St #03-68</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSTYPE</th> <td></td> </tr><tr bgcolor=\"\"> <th>DESCRIPTION</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>HYPERLINK</th> <td></td> </tr><tr bgcolor=\"\"> <th>LANDXADDRESSPOINT</th> <td>0</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LANDYADDRESSPOINT</th> <td>0</td> </tr><tr bgcolor=\"\"> <th>NAME</th> <td>Kreta Ayer Senior Activity Centre (Banda)</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PHOTOURL</th> <td></td> </tr><tr bgcolor=\"\"> <th>ADDRESSFLOORNUMBER</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>BCA8DC14F5DC7133</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20160728192327</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSUNITNUMBER</th> <td></td> </tr></table></center> \nmax values  : kml_99,      <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSBLOCKHOUSENUMBER</th> <td></td> </tr><tr bgcolor=\"\"> <th>ADDRESSBUILDINGNAME</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSPOSTALCODE</th> <td>822211</td> </tr><tr bgcolor=\"\"> <th>ADDRESSSTREETNAME</th> <td>Blk 211B Punggol Walk</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSTYPE</th> <td></td> </tr><tr bgcolor=\"\"> <th>DESCRIPTION</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>HYPERLINK</th> <td></td> </tr><tr bgcolor=\"\"> <th>LANDXADDRESSPOINT</th> <td>0</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LANDYADDRESSPOINT</th> <td>0</td> </tr><tr bgcolor=\"\"> <th>NAME</th> <td>Pacific Activity Centres Pte Ltd</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PHOTOURL</th> <td></td> </tr><tr bgcolor=\"\"> <th>ADDRESSFLOORNUMBER</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>81B7D19CD919CEEA</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20160728192327</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESSUNITNUMBER</th> <td></td> </tr></table></center> \n```\n\n\n:::\n\n```{.r .cell-code}\nsg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatialPolygonsDataFrame \nfeatures    : 60 \nextent      : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 4\nnames       : GDO_GID, MSLINK, MAPID,              COSTAL_NAM \nmin values  :       1,      1,     0,             ISLAND LINK \nmax values  :      60,     67,     0, SINGAPORE - MAIN ISLAND \n```\n\n\n:::\n:::\n\n\n## 5.2 Convert the Spatial class into generic sp format\n\n\n::: {.cell}\n\n```{.r .cell-code}\nec_sp <- as(ec, \"SpatialPoints\")\nsg_sp <- as(sg, \"SpatialPolygons\")\nec_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatialPoints \nfeatures    : 133 \nextent      : 14481.92, 41665.14, 28218.43, 46804.9  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \n```\n\n\n:::\n\n```{.r .cell-code}\nsg_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatialPolygons \nfeatures    : 60 \nextent      : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \n```\n\n\n:::\n:::\n\n\n## 5.3 Convert generic sp format inso spatstat ppp format\n\n\n::: {.cell}\n\n```{.r .cell-code}\nec_ppp <- as.ppp(eldercare)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(eldercare): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\nec_ppp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern: 133 points\nmarks are of storage type  'character'\nwindow: rectangle = [14481.92, 41665.14] x [28218.43, 46804.9] units\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(ec_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  133 points\nAverage intensity 2.632412e-07 points per square unit\n\nCoordinates are given to 11 decimal places\n\nmarks are of type 'character'\nSummary:\n   Length     Class      Mode \n      133 character character \n\nWindow: rectangle = [14481.92, 41665.14] x [28218.43, 46804.9] units\n                    (27180 x 18590 units)\nWindow area = 505240000 square units\n```\n\n\n:::\n:::\n\n\n## 5.4 Check for duplicate values\n\nAlthough the summary does not say that there are duplicate values, we will just do a check to make sure that we did not miss out anything.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(ec_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n## 5.5 Creating owin object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_owin <- as.owin(sg_sf)\nplot(sg_owin)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## 5.6 Combining point events objects and owin object\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercareSG_ppp = ec_ppp[sg_owin]\nplot(eldercareSG_ppp)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Only 10 out of 133 symbols are shown in the symbol map\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n# 6.0 1st Order Spatial Point Pattern Analysis\n\n## 6.1 Kernel Density Estimation (KDE)\n\nI would like to compute the KDE of eldercare services in Singapore.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_eldercareSG_bw <- density(eldercareSG_ppp, sigma=bw.diggle, edge=TRUE, kernel=\"gaussian\")\n\nplot(kde_eldercareSG_bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## 6.2 Rescalling KDE values\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercareSG_ppp.km <- rescale.ppp(eldercareSG_ppp, 1000, \"km\")\nkde_eldercareSG.bw <- density(eldercareSG_ppp.km, sigma=bw.diggle, edge=TRUE, kernel=\"gaussian\")\nplot(kde_eldercareSG.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n# 7.0 Comparing Spatial Point Patterns using KDE\n\n## 7.1 Extracting study area\n\nI will focus on certain planning areas in Singapore\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:raster':\n\n    intersect, select, union\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:nlme':\n\n    collapse\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntoapayoh <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"TOA PAYOH\")\nbukitmerah <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"BUKIT MERAH\")\nbishan <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"BISHAN\")\namk <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"ANG MO KIO\")\njuronge <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"JURONG EAST\")\nwoodlands <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"WOODLANDS\")\nchangi <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"CHANGI\")\npasirris <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"PASIR RIS\")\nbedok <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"BEDOK\")\ntm <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"TAMPINES\")\npunggol <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"CHOA CHU KANG\")\nyishun <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"YISHUN\")\nsembawang <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"SEMBAWANG\")\nbukitbatok <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"BUKIT BATOK\")\njurongw <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"JURONG WEST\")\n```\n:::\n\n\n## 7.2 Creating owin object\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntp_owin = as.owin(toapayoh)\nbs_owin = as.owin(bishan)\namk_owin = as.owin(amk)\nje_owin = as.owin(juronge)\nwdlds_owin = as.owin(woodlands)\nchangi_owin = as.owin(changi)\npr_owin = as.owin(pasirris)\nbedok_owin = as.owin(bedok)\ntm_owin = as.owin(tm)\npg_owin = as.owin(punggol)\nys_owin = as.owin(yishun)\nsbw_owin = as.owin(sembawang)\nbb_owin = as.owin(bukitbatok)\njw_owin = as.owin(jurongw)\n```\n:::\n\n\n## 7.3 Combining eldercare points and study area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nec_tp_ppp = ec_ppp[tp_owin]\nec_bs_ppp = ec_ppp[bs_owin]\nec_amk_ppp = ec_ppp[amk_owin]\nec_je_ppp = ec_ppp[je_owin]\nec_wdlds_ppp = ec_ppp[wdlds_owin]\nec_changi_ppp = ec_ppp[changi_owin]\nec_pr_ppp = ec_ppp[pr_owin]\nec_bedok_ppp = ec_ppp[bedok_owin]\nec_tm_ppp = ec_ppp[tm_owin]\nec_pg_ppp = ec_ppp[pg_owin]\nec_ys_ppp = ec_ppp[ys_owin]\nec_sbw_ppp = ec_ppp[sbw_owin]\nec_bb_ppp = ec_ppp[bb_owin]\nec_jw_ppp = ec_ppp[jw_owin]\n```\n:::\n\n\n## 7.4 Rescalling\n\n\n::: {.cell}\n\n```{.r .cell-code}\nec_tp_ppp.km = rescale.ppp(ec_tp_ppp, 1000, \"km\")\nec_bs_ppp.km = rescale.ppp(ec_bs_ppp, 1000, \"km\")\nec_amk_ppp.km = rescale.ppp(ec_amk_ppp, 1000, \"km\")\nec_je_ppp.km = rescale.ppp(ec_je_ppp, 1000, \"km\")\nec_wdlds_ppp.km = rescale.ppp(ec_wdlds_ppp, 1000, \"km\")\nec_changi_ppp.km = rescale.ppp(ec_changi_ppp, 1000, \"km\")\nec_pr_ppp.km = rescale.ppp(ec_pr_ppp, 1000, \"km\")\nec_bedok_ppp.km = rescale.ppp(ec_bedok_ppp, 1000, \"km\")\nec_tm_ppp.km = rescale.ppp(ec_tm_ppp, 1000, \"km\")\nec_pg_ppp.km = rescale.ppp(ec_pg_ppp, 1000, \"km\")\nec_ys_ppp.km = rescale.ppp(ec_ys_ppp, 1000, \"km\")\nec_sbw_ppp.km = rescale.ppp(ec_sbw_ppp, 1000, \"km\")\nec_bb_ppp.km = rescale.ppp(ec_bb_ppp, 1000, \"km\")\nec_jw_ppp.km = rescale.ppp(ec_jw_ppp, 1000, \"km\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(ec_changi_ppp.km)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  0 points\nAverage intensity 0 points per square km\n\nCoordinates are integers\ni.e. rounded to the nearest km\n\nmarks are of type 'character'\nSummary:\n   Length     Class      Mode \n        0 character character \n\nWindow: polygonal boundary\nsingle connected closed polygon with 800 vertices\nenclosing rectangle: [42.57532, 50.29396] x [32.52441, 41.74324] km\n                     (7.719 x 9.219 km)\nWindow area = 40.9405 square km\nUnit of length: 1 km\nFraction of frame area: 0.575\n```\n\n\n:::\n:::\n\n\n## 7.5 Computing KDE\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# par(mfrow=c(2,2))\nplot(density(ec_tp_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Toa Payoh\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Berman-Diggle Cross-Validation criterion was minimised at right-hand\nend of interval [0, 0.119]; use argument 'hmax' to specify a wider interval for\nbandwidth 'sigma'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_bs_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Bishan\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Berman-Diggle Cross-Validation criterion was minimised at right-hand\nend of interval [0, 0.179]; use argument 'hmax' to specify a wider interval for\nbandwidth 'sigma'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_amk_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Ang Mo Kio\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_je_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Jurong East\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-4.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_wdlds_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Woodlands\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# \n# plot(density(ec_changi_ppp.km, \n#              sigma=bw.diggle, \n#              edge=TRUE, \n#              kernel=\"gaussian\"),\n#      main=\"Changi\")\n\n# plot(density(ec_pr_ppp.km, \n#              sigma=bw.diggle, \n#              edge=TRUE, \n#              kernel=\"gaussian\"),\n#      main=\"Pasir Ris\")\n\nplot(density(ec_bedok_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Bedok\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-6.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_tm_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Tampines\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-7.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_pg_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Punggol\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Berman-Diggle Cross-Validation criterion was minimised at right-hand\nend of interval [0, 0.198]; use argument 'hmax' to specify a wider interval for\nbandwidth 'sigma'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-8.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_ys_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Yishun\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-9.png){width=672}\n:::\n\n```{.r .cell-code}\n# plot(density(ec_sbw_ppp.km, \n#              sigma=bw.diggle, \n#              edge=TRUE, \n#              kernel=\"gaussian\"),\n#      main=\"Sembawang\")\n\nplot(density(ec_bb_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Bukit Batok\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Berman-Diggle Cross-Validation criterion was minimised at right-hand\nend of interval [0, 0.235]; use argument 'hmax' to specify a wider interval for\nbandwidth 'sigma'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-10.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(density(ec_jw_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Jurong West\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-11.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}